<div class="space-y-6">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between">
    <h3 class="text-lg font-semibold text-gray-900 dark:text-white">âš™ï¸ ç³»ç»Ÿé…ç½®</h3>
    <div class="mt-4 sm:mt-0">
          <button id="saveConfigBtn" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm font-medium" onclick="handleSaveConfigClick(event)">
      ä¿å­˜é…ç½®
    </button>
    </div>
  </div>

  <!-- é…ç½®æ ‡ç­¾é¡µ -->
  <div class="border-b border-gray-200 dark:border-gray-700">
    <nav class="-mb-px flex flex-wrap gap-4 sm:gap-8" aria-label="é…ç½®æ ‡ç­¾é¡µ">
      <button class="config-tab-btn border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-3 px-4 border-b-2 font-medium text-sm transition-colors duration-200" data-tab="basic">
        åŸºæœ¬è®¾ç½®
      </button>
      <button class="config-tab-btn border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-3 px-4 border-b-2 font-medium text-sm transition-colors duration-200" data-tab="study">
        å­¦ä¹ è®¾ç½®
      </button>
      <button class="config-tab-btn border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-3 px-4 border-b-2 font-medium text-sm transition-colors duration-200" data-tab="notification">
        é€šçŸ¥è®¾ç½®
      </button>
      <button class="config-tab-btn border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-3 px-4 border-b-2 font-medium text-sm transition-colors duration-200" data-tab="security">
        å®‰å…¨è®¾ç½®
      </button>
      <button class="config-tab-btn border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-3 px-4 border-b-2 font-medium text-sm transition-colors duration-200" data-tab="smtp">
        SMTPé‚®ç®±è®¾ç½®
      </button>
      <button class="config-tab-btn border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-3 px-4 border-b-2 font-medium text-sm transition-colors duration-200" data-tab="advanced">
        é«˜çº§è®¾ç½®
      </button>
    </nav>
  </div>

  <!-- é…ç½®å†…å®¹åŒºåŸŸ -->
  <div id="configContent">
    <!-- åŸºæœ¬è®¾ç½® -->
    <div id="basicConfig" class="config-tab-content">
      <div class="bg-white dark:bg-gray-800 shadow rounded-lg p-6">
        <form id="basicConfigForm" class="space-y-6">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">ç³»ç»Ÿåç§°</label>
              <input type="text" id="systemName" name="systemName" 
                     class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                     autocomplete="off">
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">ç³»ç»Ÿç‰ˆæœ¬</label>
              <input type="text" id="systemVersion" name="systemVersion" readonly
                     class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">ç®¡ç†å‘˜é‚®ç®±</label>
              <input type="email" id="adminEmail" name="adminEmail" 
                     class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                     autocomplete="email">
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">æ—¶åŒºè®¾ç½®</label>
              <select id="timezone" name="timezone" 
                      class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                <option value="Asia/Shanghai">ä¸­å›½æ ‡å‡†æ—¶é—´ (UTC+8)</option>
                <option value="UTC">åè°ƒä¸–ç•Œæ—¶ (UTC)</option>
                <option value="America/New_York">ç¾å›½ä¸œéƒ¨æ—¶é—´ (UTC-5)</option>
                <option value="Europe/London">è‹±å›½æ—¶é—´ (UTC+0)</option>
              </select>
            </div>
          </div>
        </form>
      </div>
    </div>

    <!-- å­¦ä¹ è®¾ç½® -->
    <div id="studyConfig" class="config-tab-content hidden">
      <div class="bg-white dark:bg-gray-800 shadow rounded-lg p-6">
        <form id="studyConfigForm" class="space-y-6">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">é»˜è®¤å­¦ä¹ æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰</label>
              <input type="number" id="defaultStudyTime" name="defaultStudyTime" min="1" max="480"
                     class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">æ¯æ—¥å­¦ä¹ ç›®æ ‡ï¼ˆåˆ†é’Ÿï¼‰</label>
              <input type="number" id="dailyGoal" name="dailyGoal" min="1" max="1440"
                     class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">å­¦ä¹ æé†’æ—¶é—´</label>
              <input type="time" id="reminderTime" name="reminderTime"
                     class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">è‡ªåŠ¨ä¿å­˜é—´éš”ï¼ˆç§’ï¼‰</label>
              <input type="number" id="autoSaveInterval" name="autoSaveInterval" min="30" max="300"
                     class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
          </div>
        </form>
      </div>
    </div>

    <!-- é€šçŸ¥è®¾ç½® -->
    <div id="notificationConfig" class="config-tab-content hidden">
      <div class="bg-white dark:bg-gray-800 shadow rounded-lg p-6">
        <form id="notificationConfigForm" class="space-y-6">
          <div class="space-y-4">
            <div class="flex items-center justify-between">
              <div>
                <h5 class="text-sm font-medium text-gray-900 dark:text-white">æµè§ˆå™¨é€šçŸ¥</h5>
                <p class="text-sm text-gray-600 dark:text-gray-400">å¯ç”¨æµè§ˆå™¨æ¨é€é€šçŸ¥</p>
              </div>
              <label class="relative inline-flex items-center cursor-pointer">
                <input type="checkbox" id="browserNotifications" name="browserNotifications" class="sr-only peer">
                <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"></div>
              </label>
            </div>
            <div class="flex items-center justify-between">
              <div>
                <h5 class="text-sm font-medium text-gray-900 dark:text-white">å­¦ä¹ æé†’</h5>
                <p class="text-sm text-gray-600 dark:text-gray-400">æ¯æ—¥å­¦ä¹ æ—¶é—´æé†’</p>
              </div>
              <label class="relative inline-flex items-center cursor-pointer">
                <input type="checkbox" id="studyReminders" name="studyReminders" class="sr-only peer">
                <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"></div>
              </label>
            </div>
          </div>
        </form>
      </div>
    </div>

    <!-- å®‰å…¨è®¾ç½® -->
    <div id="securityConfig" class="config-tab-content hidden">
      <div class="bg-white dark:bg-gray-800 shadow rounded-lg p-6">
        <form id="securityConfigForm" class="space-y-6">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">ä¼šè¯è¶…æ—¶æ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰</label>
              <input type="number" id="sessionTimeout" name="sessionTimeout" min="5" max="1440"
                     class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">æœ€å¤§ç™»å½•å°è¯•æ¬¡æ•°</label>
              <input type="number" id="maxLoginAttempts" name="maxLoginAttempts" min="3" max="10"
                     class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">å¯†ç æœ€å°é•¿åº¦</label>
              <input type="number" id="minPasswordLength" name="minPasswordLength" min="6" max="20"
                     class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">æ•°æ®å¤‡ä»½é¢‘ç‡ï¼ˆå¤©ï¼‰</label>
              <input type="number" id="backupFrequency" name="backupFrequency" min="1" max="30"
                     class="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
          </div>
        </form>
      </div>
    </div>

    <!-- SMTPé‚®ç®±è®¾ç½® -->
    <div id="smtpConfig" class="config-tab-content hidden">
      <!-- SMTPé…ç½®å†…å®¹å°†é€šè¿‡AJAXåŠ è½½ -->
      <div id="smtpConfigContent" class="text-center py-8">
        <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"></div>
        <p class="mt-2 text-gray-600">åŠ è½½SMTPé…ç½®ä¸­...</p>
      </div>
    </div>

    <!-- é«˜çº§è®¾ç½® -->
    <div id="advancedConfig" class="config-tab-content hidden">
      <div class="bg-white dark:bg-gray-800 shadow rounded-lg p-6">
        <form id="advancedConfigForm" class="space-y-6">
          <div class="space-y-4">
            <div class="flex items-center justify-between">
              <div>
                <h5 class="text-sm font-medium text-gray-900 dark:text-white">è°ƒè¯•æ¨¡å¼</h5>
                <p class="text-sm text-gray-600 dark:text-gray-400">å¯ç”¨è¯¦ç»†çš„é”™è¯¯æ—¥å¿—å’Œè°ƒè¯•ä¿¡æ¯</p>
              </div>
              <label class="relative inline-flex items-center cursor-pointer">
                <input type="checkbox" id="debugMode" name="debugMode" class="sr-only peer">
                <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"></div>
              </label>
            </div>
            <div class="flex items-center justify-between">
              <div>
                <h5 class="text-sm font-medium text-gray-900 dark:text-white">ç»´æŠ¤æ¨¡å¼</h5>
                <p class="text-sm text-gray-600 dark:text-gray-400">å¯ç”¨ç³»ç»Ÿç»´æŠ¤æ¨¡å¼ï¼Œé™åˆ¶ç”¨æˆ·è®¿é—®</p>
              </div>
              <label class="relative inline-flex items-center cursor-pointer">
                <input type="checkbox" id="maintenanceMode" name="maintenanceMode" class="sr-only peer">
                <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"></div>
              </label>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- ç³»ç»Ÿä¿¡æ¯ -->
  <div class="bg-white dark:bg-gray-800 shadow rounded-lg p-6">
    <div class="flex items-center justify-between mb-4">
      <h4 class="text-lg font-medium text-gray-900 dark:text-white">ç³»ç»Ÿä¿¡æ¯</h4>
      <button id="refreshSystemInfoBtn" class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded-md text-sm font-medium" onclick="refreshSystemInfo()">
        <i class="fas fa-sync-alt mr-1"></i>åˆ·æ–°
      </button>
    </div>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <div>
        <h5 class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">æœåŠ¡å™¨ä¿¡æ¯</h5>
        <div class="space-y-3 text-sm text-gray-600 dark:text-gray-400">
          <div class="flex items-center justify-between h-6">
            <span class="flex-shrink-0">Node.js ç‰ˆæœ¬:</span>
            <div class="flex items-center space-x-2">
              <span id="nodeVersion" class="font-mono text-right min-w-[80px]">-</span>
              <span class="text-xs text-gray-400">(é™æ€)</span>
            </div>
          </div>
          <div class="flex items-center justify-between h-6">
            <span class="flex-shrink-0">æ•°æ®åº“ç±»å‹:</span>
            <div class="flex items-center space-x-2">
              <span id="dbType" class="font-mono text-right min-w-[80px]">-</span>
              <span class="text-xs text-gray-400">(é™æ€)</span>
            </div>
          </div>
          <div class="flex items-center justify-between h-6">
            <span class="flex-shrink-0">æ•°æ®åº“ç‰ˆæœ¬:</span>
            <div class="flex items-center space-x-2">
              <span id="dbVersion" class="font-mono text-right min-w-[80px]">-</span>
              <span class="text-xs text-gray-400">(é™æ€)</span>
            </div>
          </div>
          <div class="flex items-center justify-between h-6">
            <span class="flex-shrink-0">è¿è¡Œæ—¶é—´:</span>
            <div class="flex items-center space-x-2">
              <span id="uptime" class="font-mono text-right min-w-[80px]">-</span>
              <span class="text-xs text-blue-500">(30ç§’)</span>
            </div>
          </div>
        </div>
      </div>
      <div>
        <h5 class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">ç³»ç»Ÿèµ„æº</h5>
        <div class="space-y-3 text-sm text-gray-600 dark:text-gray-400">
          <div class="flex items-center justify-between h-6">
            <span class="flex-shrink-0">å†…å­˜ä½¿ç”¨ç‡:</span>
            <div class="flex items-center space-x-2">
              <span id="memoryUsageText" class="font-mono text-right min-w-[80px]">--%</span>
              <span class="text-xs text-blue-500">(30ç§’)</span>
            </div>
          </div>
          <div class="flex items-center justify-between h-6">
            <span class="flex-shrink-0">CPU ä½¿ç”¨ç‡:</span>
            <div class="flex items-center space-x-2">
              <span id="cpuUsageText" class="font-mono text-right min-w-[80px]">--%</span>
              <span class="text-xs text-blue-500">(30ç§’)</span>
            </div>
          </div>
          <div class="flex items-center justify-between h-6">
            <span class="flex-shrink-0">ç£ç›˜ç©ºé—´ä½¿ç”¨ç‡:</span>
            <div class="flex items-center space-x-2">
              <span id="diskSpaceText" class="font-mono text-right min-w-[80px]">--%</span>
              <span class="text-xs text-green-500">(6å°æ—¶)</span>
            </div>
          </div>
          <div class="flex items-center justify-between h-6">
            <span class="flex-shrink-0">è¿æ¥æ•°:</span>
            <div class="flex items-center space-x-2">
              <span id="connections" class="font-mono text-right min-w-[80px]">-</span>
              <span class="text-xs text-blue-500">(30ç§’)</span>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="mt-4 pt-4 border-t border-gray-200 dark:border-gray-700">
      <div class="text-xs text-gray-500 dark:text-gray-400">
        <div class="flex items-center space-x-4">
          <span class="flex items-center">
            <span class="w-2 h-2 bg-gray-400 rounded-full mr-1"></span>
            é™æ€ä¿¡æ¯ (ç™»å½•æ—¶è·å–)
          </span>
          <span class="flex items-center">
            <span class="w-2 h-2 bg-blue-500 rounded-full mr-1"></span>
            30ç§’æ›´æ–°
          </span>
          <span class="flex items-center">
            <span class="w-2 h-2 bg-green-500 rounded-full mr-1"></span>
            6å°æ—¶æ›´æ–°
          </span>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
// ç³»ç»Ÿé…ç½®é¡µé¢åˆå§‹åŒ–
(function() {
  console.log('=== ç³»ç»Ÿé…ç½®é¡µé¢åŠ è½½å®Œæˆ ===');
  
  // å…¨å±€ä¿å­˜é…ç½®å‡½æ•°
  window.handleSaveConfigClick = function(event) {
    event.preventDefault();
    event.stopPropagation();
    console.log('ğŸ”¥ ä¿å­˜æŒ‰é’®è¢«ç‚¹å‡»ï¼ˆå…¨å±€å‡½æ•°ï¼‰');
    
    // ç«‹å³æ˜¾ç¤ºåé¦ˆ
    showMessage('æ­£åœ¨ä¿å­˜é…ç½®...', 'info');
    
    // å°è¯•è°ƒç”¨AdminAppçš„ä¿å­˜æ–¹æ³•
    if (window.adminApp && window.adminApp.saveAllConfig) {
      console.log('è°ƒç”¨ AdminApp.saveAllConfig');
      window.adminApp.saveAllConfig();
    } else if (window.currentAdminApp && window.currentAdminApp.saveAllConfig) {
      console.log('è°ƒç”¨ currentAdminApp.saveAllConfig');
      window.currentAdminApp.saveAllConfig();
    } else {
      console.log('AdminApp ä¸å¯ç”¨ï¼Œä½¿ç”¨å¤‡ç”¨ä¿å­˜æ–¹æ³•');
      saveConfigDirectly();
    }
  };
  
  // å¤‡ç”¨ä¿å­˜æ–¹æ³•
  window.saveConfigDirectly = async function() {
    try {
      // æ”¶é›†æ‰€æœ‰é…ç½®æ•°æ®
      const configData = {
        systemName: document.getElementById('systemName')?.value || '',
        systemVersion: document.getElementById('systemVersion')?.value || '',
        adminEmail: document.getElementById('adminEmail')?.value || '',
        timezone: document.getElementById('timezone')?.value || 'Asia/Shanghai',
        // æ·»åŠ æ›´å¤šé…ç½®é¡¹
        emailRateLimit: document.getElementById('emailRateLimit')?.value || 60,
        smtpEnabled: document.getElementById('smtpEnabled')?.checked || false,
        emailVerificationEnabled: document.getElementById('emailVerificationEnabled')?.checked || false,
        debugMode: document.getElementById('debugMode')?.checked || false,
        maintenanceMode: document.getElementById('maintenanceMode')?.checked || false
      };
      
      console.log('ğŸ”¥ å¤‡ç”¨ä¿å­˜æ–¹æ³•ï¼Œæ”¶é›†åˆ°çš„æ•°æ®:', configData);
      
      const response = await fetch('/api/admin/config', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        credentials: 'include',
        body: JSON.stringify(configData)
      });
      
      const data = await response.json();
      
      if (data.success) {
        console.log('ğŸ”¥ æœåŠ¡å™¨è¿”å›æˆåŠŸ:', data);
        showMessage('é…ç½®ä¿å­˜æˆåŠŸï¼', 'success');
        
        // æ·»åŠ éªŒè¯ï¼šé‡æ–°åŠ è½½é…ç½®æ¥ç¡®è®¤æ˜¯å¦çœŸçš„ä¿å­˜äº†
        setTimeout(() => {
          console.log('ğŸ”¥ 3ç§’åé‡æ–°åŠ è½½é…ç½®è¿›è¡ŒéªŒè¯...');
          loadSystemConfig();
        }, 3000);
      } else {
        console.error('ğŸ”¥ æœåŠ¡å™¨è¿”å›å¤±è´¥:', data);
        showMessage('é…ç½®ä¿å­˜å¤±è´¥: ' + data.error, 'error');
      }
    } catch (error) {
      console.error('å¤‡ç”¨ä¿å­˜æ–¹æ³•é”™è¯¯:', error);
      showMessage('ä¿å­˜å¤±è´¥: ' + error.message, 'error');
    }
  };
  
  // æ¶ˆæ¯æ˜¾ç¤ºå‡½æ•°
  window.showMessage = function(message, type = 'info') {
    console.log(`ğŸ”¥ æ˜¾ç¤ºæ¶ˆæ¯ [${type}]:`, message);
    
    // ç§»é™¤å¯èƒ½å­˜åœ¨çš„æ—§æ¶ˆæ¯
    const existingMessages = document.querySelectorAll('.config-message');
    existingMessages.forEach(msg => msg.remove());
    
    // åˆ›å»ºæ¶ˆæ¯å…ƒç´ 
    const messageDiv = document.createElement('div');
    messageDiv.className = `config-message fixed top-4 right-4 px-6 py-3 rounded-md text-white z-[9999] shadow-lg ${
      type === 'success' ? 'bg-green-600' : 
      type === 'error' ? 'bg-red-600' : 'bg-blue-600'
    }`;
    messageDiv.textContent = message;
    
    // æ·»åŠ åŠ¨ç”»æ•ˆæœ
    messageDiv.style.opacity = '0';
    messageDiv.style.transform = 'translateY(-20px)';
    messageDiv.style.transition = 'all 0.3s ease';
    
    // æ·»åŠ åˆ°é¡µé¢
    document.body.appendChild(messageDiv);
    
    // è§¦å‘åŠ¨ç”»
    setTimeout(() => {
      messageDiv.style.opacity = '1';
      messageDiv.style.transform = 'translateY(0)';
    }, 10);
    
    // 3ç§’åç§»é™¤
    setTimeout(() => {
      if (messageDiv.parentNode) {
        messageDiv.style.opacity = '0';
        messageDiv.style.transform = 'translateY(-20px)';
        setTimeout(() => {
          if (messageDiv.parentNode) {
            messageDiv.parentNode.removeChild(messageDiv);
          }
        }, 300);
      }
    }, 3000);
  };
  
  // æ ¼å¼åŒ–è¿è¡Œæ—¶é—´å‡½æ•°
  window.formatUptime = function(seconds) {
    const days = Math.floor(seconds / 86400);
    const hours = Math.floor((seconds % 86400) / 3600);
    const minutes = Math.floor((seconds % 3600) / 60);
    
    if (days > 0) {
      return `${days}å¤© ${hours}å°æ—¶ ${minutes}åˆ†é’Ÿ`;
    } else if (hours > 0) {
      return `${hours}å°æ—¶ ${minutes}åˆ†é’Ÿ`;
    } else {
      return `${minutes}åˆ†é’Ÿ`;
    }
  };
  
  // é‡æ–°åŠ è½½ç³»ç»Ÿé…ç½®å‡½æ•°
  window.loadSystemConfig = async function() {
    try {
      console.log('ğŸ”¥ å¼€å§‹é‡æ–°åŠ è½½ç³»ç»Ÿé…ç½®...');
      const response = await fetch('/api/admin/config', {
        method: 'GET',
        credentials: 'include'
      });
      
      const data = await response.json();
      console.log('ğŸ”¥ é‡æ–°åŠ è½½çš„é…ç½®æ•°æ®:', data);
      
      if (data.success && data.config) {
        // æ›´æ–°è¡¨å•å­—æ®µ
        const config = data.config;
        if (document.getElementById('systemName')) document.getElementById('systemName').value = config.systemName || '';
        if (document.getElementById('systemVersion')) document.getElementById('systemVersion').value = config.systemVersion || '';
        if (document.getElementById('adminEmail')) document.getElementById('adminEmail').value = config.adminEmail || '';
        if (document.getElementById('timezone')) document.getElementById('timezone').value = config.timezone || 'Asia/Shanghai';
        if (document.getElementById('emailRateLimit')) document.getElementById('emailRateLimit').value = config.emailRateLimit || 60;
        if (document.getElementById('smtpEnabled')) document.getElementById('smtpEnabled').checked = config.smtpEnabled || false;
        if (document.getElementById('emailVerificationEnabled')) document.getElementById('emailVerificationEnabled').checked = config.emailVerificationEnabled || false;
        if (document.getElementById('debugMode')) document.getElementById('debugMode').checked = config.debugMode || false;
        if (document.getElementById('maintenanceMode')) document.getElementById('maintenanceMode').checked = config.maintenanceMode || false;
        
        console.log('ğŸ”¥ é…ç½®é‡æ–°åŠ è½½å®Œæˆï¼Œè¡¨å•å·²æ›´æ–°');
        showMessage('é…ç½®é‡æ–°åŠ è½½å®Œæˆï¼', 'success');
      } else {
        console.error('ğŸ”¥ é‡æ–°åŠ è½½é…ç½®å¤±è´¥:', data);
        showMessage('é‡æ–°åŠ è½½é…ç½®å¤±è´¥: ' + (data.error || 'æœªçŸ¥é”™è¯¯'), 'error');
      }
    } catch (error) {
      console.error('ğŸ”¥ é‡æ–°åŠ è½½é…ç½®å‡ºé”™:', error);
      showMessage('é‡æ–°åŠ è½½é…ç½®å‡ºé”™: ' + error.message, 'error');
    }
  };
  
  console.log('ç³»ç»Ÿé…ç½®é¡µé¢è„šæœ¬åŠ è½½å®Œæˆ');
})();
</script> 