<!-- Desktop Sidebar -->
<div class="hidden lg:flex lg:flex-shrink-0">
    <div class="flex flex-col w-64 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700">
        <!-- Logo -->
        <div class="flex items-center h-16 px-6 border-b border-gray-200 dark:border-gray-700">
            <h1 class="text-xl font-bold text-gray-900 dark:text-white" id="sidebarSystemName">ğŸ“š å­¦ä¹ è¿½è¸ª</h1>
        </div>
        
        <!-- Navigation -->
        <nav class="flex-1 px-4 py-6 space-y-2">
            <a href="{{#if isDemo}}/demo/dashboard{{else}}/dashboard{{/if}}" 
                class="nav-link flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors duration-200 {{#if (eq currentPage 'dashboard')}}bg-primary-100 text-primary-700 dark:bg-primary-900 dark:text-primary-300{{else}}text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700{{/if}}"
                data-content="dashboard">
                <span class="mr-3">ğŸ“Š</span>
                ä»ªè¡¨æ¿
            </a>
            
            <a href="{{#if isDemo}}/demo/projects{{else}}/projects{{/if}}" 
                class="nav-link flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors duration-200 {{#if (eq currentPage 'projects')}}bg-primary-100 text-primary-700 dark:bg-primary-900 dark:text-primary-300{{else}}text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700{{/if}}"
                data-content="projects">
                <span class="mr-3">ğŸ“</span>
                é¡¹ç›®ç®¡ç†
            </a>
            
            <a href="{{#if isDemo}}/demo/sessions{{else}}/sessions{{/if}}" 
                class="nav-link flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors duration-200 {{#if (eq currentPage 'sessions')}}bg-primary-100 text-primary-700 dark:bg-primary-900 dark:text-primary-300{{else}}text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700{{/if}}"
                data-content="sessions">
                <span class="mr-3">â±ï¸</span>
                å­¦ä¹ è®°å½•
            </a>
            
            <a href="{{#if isDemo}}/demo/notifications{{else}}/notifications{{/if}}" 
                class="nav-link flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors duration-200 {{#if (eq currentPage 'notifications')}}bg-primary-100 text-primary-700 dark:bg-primary-900 dark:text-primary-300{{else}}text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700{{/if}}"
                data-content="notifications">
                <span class="mr-3">ğŸ””</span>
                é€šçŸ¥ä¸­å¿ƒ
                <span id="notificationBadge" class="ml-auto bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center font-bold hidden">
                    <span id="notificationCount">0</span>
                </span>
            </a>
            
            <a href="{{#if isDemo}}/demo/achievements{{else}}/achievements{{/if}}" 
                class="nav-link flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors duration-200 {{#if (eq currentPage 'achievements')}}bg-primary-100 text-primary-700 dark:bg-primary-900 dark:text-primary-300{{else}}text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700{{/if}}"
                data-content="achievements">
                <span class="mr-3">ğŸ†</span>
                æˆå°±å¾½ç« 
            </a>

            <!-- ç§¯åˆ†å…‘æ¢ç›¸å…³é“¾æ¥ -->
            <div class="pt-2 border-t border-gray-200 dark:border-gray-700">
                <a href="{{#if isDemo}}/demo/points-exchange{{else}}/points-exchange{{/if}}" 
                    class="nav-link flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors duration-200 {{#if (eq currentPage 'points-exchange')}}bg-primary-100 text-primary-700 dark:bg-primary-900 dark:text-primary-300{{else}}text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700{{/if}}"
                    data-content="points-exchange">
                    <span class="mr-3">ğŸ</span>
                    ç§¯åˆ†å…‘æ¢
                </a>
                
                <a href="{{#if isDemo}}/demo/exchange-records{{else}}/exchange-records{{/if}}" 
                    class="nav-link flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors duration-200 {{#if (eq currentPage 'exchange-records')}}bg-primary-100 text-primary-700 dark:bg-primary-900 dark:text-primary-300{{else}}text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700{{/if}}"
                    data-content="exchange-records">
                    <span class="mr-3">ğŸ“‹</span>
                    å…‘æ¢è®°å½•
                </a>
                
                <a href="{{#if isDemo}}/demo/points-records{{else}}/points-records{{/if}}" 
                    class="nav-link flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors duration-200 {{#if (eq currentPage 'points-records')}}bg-primary-100 text-primary-700 dark:bg-primary-900 dark:text-primary-300{{else}}text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700{{/if}}"
                    data-content="points-records">
                    <span class="mr-3">â­</span>
                    ç§¯åˆ†æ˜ç»†
                </a>
            </div>
            
            <!-- Demoæ¨¡å¼ä¸‹ç®¡ç†å‘˜åå°å…¥å£ -->
            {{#if isDemo}}
              <div class="pt-4 border-t border-gray-200 dark:border-gray-700">
                <h3 class="px-3 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2">
                  ç®¡ç†åŠŸèƒ½
                </h3>
                <a href="/demo/admin" 
                    class="nav-link flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors duration-200 {{#if (eq currentPage 'admin')}}bg-primary-100 text-primary-700 dark:bg-primary-900 dark:text-primary-300{{else}}text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700{{/if}}"
                    data-content="admin">
                    <span class="mr-3">âš™ï¸</span>
                    ç³»ç»Ÿç®¡ç†
                </a>
                <a href="/demo/admin/points-exchange" 
                    class="nav-link flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors duration-200 {{#if (eq currentPage 'admin-points-exchange')}}bg-primary-100 text-primary-700 dark:bg-primary-900 dark:text-primary-300{{else}}text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700{{/if}}"
                    data-content="admin-points-exchange">
                    <span class="mr-3">ğŸ</span>
                    ç§¯åˆ†å…‘æ¢ç®¡ç†
                </a>
                <a href="/demo/admin/exchange-approval" 
                    class="nav-link flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors duration-200 {{#if (eq currentPage 'admin-exchange-approval')}}bg-primary-100 text-primary-700 dark:bg-primary-900 dark:text-primary-300{{else}}text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700{{/if}}"
                    data-content="admin-exchange-approval">
                    <span class="mr-3">ğŸ“‹</span>
                    å…‘æ¢å®¡æ ¸
                </a>
                <a href="/demo/dashboard" class="nav-link flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors duration-200 text-blue-700 hover:bg-blue-50 dark:text-blue-300 dark:hover:bg-blue-900" data-content="dashboard">
                  <span class="mr-3">ğŸ‘¤</span> è¿”å›ç”¨æˆ·ç«¯
                </a>
              </div>
            {{/if}}
            
            {{#if (eq user.role 'admin')}}
              {{#unless isDemo}}
            <div class="pt-4 border-t border-gray-200 dark:border-gray-700">
                <h3 class="px-3 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2">
                  ç®¡ç†åŠŸèƒ½
                </h3>
                <a href="/admin" 
                    class="nav-link flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors duration-200 {{#if (eq currentPage 'admin')}}bg-primary-100 text-primary-700 dark:bg-primary-900 dark:text-primary-300{{else}}text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700{{/if}}"
                    data-content="admin">
                    <span class="mr-3">âš™ï¸</span>
                    ç³»ç»Ÿç®¡ç†
                </a>
                <a href="/admin/points-exchange" 
                    class="nav-link flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors duration-200 {{#if (eq currentPage 'admin-points-exchange')}}bg-primary-100 text-primary-700 dark:bg-primary-900 dark:text-primary-300{{else}}text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700{{/if}}"
                    data-content="admin-points-exchange">
                    <span class="mr-3">ğŸ</span>
                    ç§¯åˆ†å…‘æ¢ç®¡ç†
                </a>
                <a href="/admin/exchange-approval" 
                    class="nav-link flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors duration-200 {{#if (eq currentPage 'admin-exchange-approval')}}bg-primary-100 text-primary-700 dark:bg-primary-900 dark:text-primary-300{{else}}text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700{{/if}}"
                    data-content="admin-exchange-approval">
                    <span class="mr-3">ğŸ“‹</span>
                    å…‘æ¢å®¡æ ¸
                </a>
              </div>
              {{/unless}}
            {{/if}}
        </nav>
        
        <!-- User Menu -->
        <div class="p-4 border-t border-gray-200 dark:border-gray-700">
            <div class="flex items-center">
                <div class="w-8 h-8 bg-gray-800 dark:bg-gray-700 rounded-full flex items-center justify-center text-white font-medium border-2 border-gray-300 dark:border-gray-600 overflow-hidden sidebar-avatar">
                    {{#if user.avatar}}
                        <img src="/uploads/avatars/{{user.avatar}}" alt="ç”¨æˆ·å¤´åƒ" class="w-full h-full object-cover">
                    {{else}}
                        {{user.username.[0]}}
                    {{/if}}
                </div>
                <div class="ml-3 flex-1">
                    <p class="text-sm font-medium text-gray-900 dark:text-white">{{user.username}}</p>
                    <p class="text-xs text-gray-500 dark:text-gray-400">{{user.email}}</p>
                </div>
                <button onclick="logout()" data-action="logout" class="ml-2 p-1 text-gray-400 hover:text-red-600 dark:hover:text-red-400 group" title="é€€å‡ºç™»å½•">
                    <svg class="w-6 h-6 transition-colors duration-200 group-hover:text-red-600 dark:group-hover:text-red-400" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h6a2 2 0 012 2v1"/>
                    </svg>
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Mobile Sidebar Overlay -->
<div id="mobileSidebarOverlay" class="fixed inset-0 z-40 lg:hidden" style="display: none;">
    <div class="fixed inset-0 bg-gray-600 bg-opacity-75"></div>
</div>

<!-- Mobile Sidebar -->
<div id="mobileSidebar" class="fixed inset-y-0 left-0 z-50 w-64 bg-white dark:bg-gray-800 transform transition-transform duration-300 ease-in-out lg:hidden -translate-x-full">
    <div class="flex flex-col h-full">
        <div class="flex items-center h-16 px-6 border-b border-gray-200 dark:border-gray-700">
            <h1 class="text-xl font-bold text-gray-900 dark:text-white" id="mobileSidebarSystemName">ğŸ“š å­¦ä¹ è¿½è¸ª</h1>
            <button id="closeMobileMenu" class="ml-auto p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300">
                <span>âœ•</span>
            </button>
        </div>
        
        <nav class="flex-1 px-4 py-6 space-y-2">
            <a href="{{#if isDemo}}/demo/dashboard{{else}}/dashboard{{/if}}" class="mobile-nav-link nav-link flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors duration-200 {{#if (eq currentPage 'dashboard')}}bg-primary-100 text-primary-700 dark:bg-primary-900 dark:text-primary-300{{else}}text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700{{/if}}" data-content="dashboard">
                <span class="mr-3">ğŸ“Š</span>
                ä»ªè¡¨æ¿
            </a>
            
            <a href="{{#if isDemo}}/demo/projects{{else}}/projects{{/if}}" class="mobile-nav-link nav-link flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors duration-200 {{#if (eq currentPage 'projects')}}bg-primary-100 text-primary-700 dark:bg-primary-900 dark:text-primary-300{{else}}text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700{{/if}}" data-content="projects">
                <span class="mr-3">ğŸ“</span>
                é¡¹ç›®ç®¡ç†
            </a>
            
            <a href="{{#if isDemo}}/demo/sessions{{else}}/sessions{{/if}}" class="mobile-nav-link nav-link flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors duration-200 {{#if (eq currentPage 'sessions')}}bg-primary-100 text-primary-700 dark:bg-primary-900 dark:text-primary-300{{else}}text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700{{/if}}" data-content="sessions">
                <span class="mr-3">â±ï¸</span>
                å­¦ä¹ è®°å½•
            </a>
            
            <a href="{{#if isDemo}}/demo/notifications{{else}}/notifications{{/if}}" class="mobile-nav-link nav-link flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors duration-200 {{#if (eq currentPage 'notifications')}}bg-primary-100 text-primary-700 dark:bg-primary-900 dark:text-primary-300{{else}}text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700{{/if}}" data-content="notifications">
                <span class="mr-3">ğŸ””</span>
                é€šçŸ¥ä¸­å¿ƒ
                <span id="mobileNotificationBadge" class="ml-auto bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center font-bold hidden">
                    <span id="mobileNotificationCount">0</span>
                </span>
            </a>
            
            <a href="{{#if isDemo}}/demo/achievements{{else}}/achievements{{/if}}" 
                class="nav-link flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors duration-200 {{#if (eq currentPage 'achievements')}}bg-primary-100 text-primary-700 dark:bg-primary-900 dark:text-primary-300{{else}}text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700{{/if}}"
                data-content="achievements">
                <span class="mr-3">ğŸ†</span>
                æˆå°±å¾½ç« 
            </a>

            <!-- ç§¯åˆ†å…‘æ¢ç›¸å…³é“¾æ¥ -->
            <div class="pt-2 border-t border-gray-200 dark:border-gray-700">
                <a href="{{#if isDemo}}/demo/points-exchange{{else}}/points-exchange{{/if}}" 
                    class="nav-link flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors duration-200 {{#if (eq currentPage 'points-exchange')}}bg-primary-100 text-primary-700 dark:bg-primary-900 dark:text-primary-300{{else}}text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700{{/if}}"
                    data-content="points-exchange">
                    <span class="mr-3">ğŸ</span>
                    ç§¯åˆ†å…‘æ¢
                </a>
                
                <a href="{{#if isDemo}}/demo/exchange-records{{else}}/exchange-records{{/if}}" 
                    class="nav-link flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors duration-200 {{#if (eq currentPage 'exchange-records')}}bg-primary-100 text-primary-700 dark:bg-primary-900 dark:text-primary-300{{else}}text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700{{/if}}"
                    data-content="exchange-records">
                    <span class="mr-3">ğŸ“‹</span>
                    å…‘æ¢è®°å½•
                </a>
                
                <a href="{{#if isDemo}}/demo/points-records{{else}}/points-records{{/if}}" 
                    class="nav-link flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors duration-200 {{#if (eq currentPage 'points-records')}}bg-primary-100 text-primary-700 dark:bg-primary-900 dark:text-primary-300{{else}}text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700{{/if}}"
                    data-content="points-records">
                    <span class="mr-3">â­</span>
                    ç§¯åˆ†æ˜ç»†
                </a>
            </div>

            <!-- Demoæ¨¡å¼ä¸‹ç®¡ç†å‘˜åå°å…¥å£ -->
            {{#if isDemo}}
              <div class="pt-4 border-t border-gray-200 dark:border-gray-700">
                <h3 class="px-3 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-2">
                  ç®¡ç†åŠŸèƒ½
                </h3>
                <a href="/demo/admin" 
                    class="nav-link flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors duration-200 {{#if (eq currentPage 'admin')}}bg-primary-100 text-primary-700 dark:bg-primary-900 dark:text-primary-300{{else}}text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700{{/if}}"
                    data-content="admin">
                    <span class="mr-3">âš™ï¸</span>
                    ç³»ç»Ÿç®¡ç†
                </a>
                <a href="/demo/admin/points-exchange" 
                    class="nav-link flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors duration-200 {{#if (eq currentPage 'admin-points-exchange')}}bg-primary-100 text-primary-700 dark:bg-primary-900 dark:text-primary-300{{else}}text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700{{/if}}"
                    data-content="admin-points-exchange">
                    <span class="mr-3">ğŸ</span>
                    ç§¯åˆ†å…‘æ¢ç®¡ç†
                </a>
                <a href="/demo/admin/exchange-approval" 
                    class="nav-link flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors duration-200 {{#if (eq currentPage 'admin-exchange-approval')}}bg-primary-100 text-primary-700 dark:bg-primary-900 dark:text-primary-300{{else}}text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700{{/if}}"
                    data-content="admin-exchange-approval">
                    <span class="mr-3">ğŸ“‹</span>
                    å…‘æ¢å®¡æ ¸
                </a>
                <a href="/demo/dashboard" class="nav-link flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors duration-200 text-blue-700 hover:bg-blue-50 dark:text-blue-300 dark:hover:bg-blue-900" data-content="dashboard">
                  <span class="mr-3">ğŸ‘¤</span> è¿”å›ç”¨æˆ·ç«¯
                </a>
              </div>
            {{/if}}
        </nav>
        
        <div class="p-4 border-t border-gray-200 dark:border-gray-700">
            <div class="flex items-center">
                <div class="w-8 h-8 bg-gray-800 dark:bg-gray-700 rounded-full flex items-center justify-center text-white font-medium border-2 border-gray-300 dark:border-gray-600 overflow-hidden mobile-sidebar-avatar">
                    {{#if user.avatar}}
                        <img src="/uploads/avatars/{{user.avatar}}" alt="ç”¨æˆ·å¤´åƒ" class="w-full h-full object-cover">
                    {{else}}
                        {{user.username.[0]}}
                    {{/if}}
                </div>
                <div class="ml-3 flex-1">
                    <p class="text-sm font-medium text-gray-900 dark:text-white">{{user.username}}</p>
                    <p class="text-xs text-gray-500 dark:text-gray-400">{{user.email}}</p>
                </div>
                <button onclick="logout()" data-action="logout" class="ml-2 p-1 text-gray-400 hover:text-red-600 dark:hover:text-red-400 group" title="é€€å‡ºç™»å½•">
                    <svg class="w-6 h-6 transition-colors duration-200 group-hover:text-red-600 dark:group-hover:text-red-400" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h6a2 2 0 012 2v1"/>
                    </svg>
                </button>
            </div>
        </div>
    </div>
</div>

<script>
// ç§»åŠ¨ç«¯èœå•æ§åˆ¶
function openMobileMenu() {
    document.getElementById('mobileSidebarOverlay').style.display = 'block';
    document.getElementById('mobileSidebar').classList.remove('-translate-x-full');
}

function closeMobileMenu() {
    document.getElementById('mobileSidebarOverlay').style.display = 'none';
    document.getElementById('mobileSidebar').classList.add('-translate-x-full');
}

// å¯¼èˆªé“¾æ¥ç‚¹å‡»å¤„ç†
function handleNavClick(e) {
    e.preventDefault();
    const link = e.currentTarget;
    const contentType = link.getAttribute('data-content');
    
    // æ›´æ–°URLä½†ä¸åˆ·æ–°é¡µé¢
    let href = link.getAttribute('href');
    
    // Demoæ¨¡å¼ä¸‹ç¡®ä¿URLåŒ…å«å‰ç¼€
    if (window.isDemo && !href.startsWith('/demo')) {
        href = '/demo' + href;
    }
    
    window.history.pushState({contentType}, '', href);
    
    // æ˜¾ç¤ºå¯¹åº”å†…å®¹
    if (typeof showContent === 'function') {
        showContent(contentType);
    }
    
    // æ›´æ–°å¯¼èˆªé“¾æ¥çš„æ¿€æ´»çŠ¶æ€
    updateNavActiveState(contentType);
    
    // ç§»åŠ¨ç«¯å…³é—­èœå•
    if (window.innerWidth < 1024) {
        closeMobileMenu();
    }
}

// æ›´æ–°å¯¼èˆªæ¿€æ´»çŠ¶æ€
function updateNavActiveState(activeContent) {
    const navLinks = document.querySelectorAll('.nav-link');
    navLinks.forEach(link => {
        const contentType = link.getAttribute('data-content');
        if (contentType === activeContent) {
            link.classList.add('bg-primary-100', 'text-primary-700', 'dark:bg-primary-900', 'dark:text-primary-300');
            link.classList.remove('text-gray-600', 'hover:bg-gray-100', 'dark:text-gray-400', 'dark:hover:bg-gray-700');
        } else {
            link.classList.remove('bg-primary-100', 'text-primary-700', 'dark:bg-primary-900', 'dark:text-primary-300');
            link.classList.add('text-gray-600', 'hover:bg-gray-100', 'dark:text-gray-400', 'dark:hover:bg-gray-700');
        }
    });
}

// é€€å‡ºç™»å½•å‡½æ•°
function logout() {
    if (confirm('ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ')) {
        fetch('/auth/logout', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            credentials: 'include'
        })
        .then(response => {
            if (response.ok) {
                // æ¸…é™¤æœ¬åœ°å­˜å‚¨
                localStorage.clear();
                sessionStorage.clear();
                
                // é‡å®šå‘åˆ°ç™»å½•é¡µé¢
                window.location.href = '/login';
            } else {
                console.error('é€€å‡ºç™»å½•å¤±è´¥');
                alert('é€€å‡ºç™»å½•å¤±è´¥ï¼Œè¯·é‡è¯•');
            }
        })
        .catch(error => {
            console.error('é€€å‡ºç™»å½•é”™è¯¯:', error);
            alert('é€€å‡ºç™»å½•å¤±è´¥ï¼Œè¯·é‡è¯•');
        });
    }
}

// äº‹ä»¶ç›‘å¬å™¨
document.addEventListener('DOMContentLoaded', function() {
    // ç§»åŠ¨ç«¯èœå•æŒ‰é’®
    const mobileMenuButton = document.getElementById('mobileMenuButton');
    if (mobileMenuButton) {
        mobileMenuButton.addEventListener('click', openMobileMenu);
    }
    
    // å…³é—­ç§»åŠ¨ç«¯èœå•
    const closeMobileMenuButton = document.getElementById('closeMobileMenu');
    if (closeMobileMenuButton) {
        closeMobileMenuButton.addEventListener('click', closeMobileMenu);
    }
    
    // ç§»åŠ¨ç«¯èœå•é®ç½©ç‚¹å‡»å…³é—­
    const mobileSidebarOverlay = document.getElementById('mobileSidebarOverlay');
    if (mobileSidebarOverlay) {
        mobileSidebarOverlay.addEventListener('click', closeMobileMenu);
    }
    
    // å¯¼èˆªé“¾æ¥ç‚¹å‡»äº‹ä»¶
    const navLinks = document.querySelectorAll('.nav-link');
    navLinks.forEach(link => {
        link.addEventListener('click', handleNavClick);
    });
    
    // ç§»åŠ¨ç«¯å¯¼èˆªé“¾æ¥ç‚¹å‡»äº‹ä»¶
    const mobileNavLinks = document.querySelectorAll('.mobile-nav-link');
    mobileNavLinks.forEach(link => {
        link.addEventListener('click', handleNavClick);
    });
});
</script> 